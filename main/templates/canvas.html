{% extends 'base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="/static/js/canvas.js">
<link rel="stylesheet" href="/static/css/canvas.css">
<div id="section">
  <div style="position: absolute;">
      <canvas id="tcanvas" width = "500" height = "800" style =' border : 1px solid #000 '; > </canvas>
      <script>
      var canvas = document.getElementById( "tcanvas" );
      var context = canvas.getContext( "2d" );
      var img = new Image(); //이미지 객체 생성
      img.src = "/media/iu.png"; //code.jpg라는 이미지 파일을 로딩 시작
      img.onload = function() //이미지 로딩 완료시 실행되는 함수
      {
      //(20,20)을 중심으로 100*100의 사이즈로 이미지를 그림
      context.drawImage(img,0,0,500,800);
      }
      </script>
  </div>
  <div style="position: absolute;">
      <canvas id="tcanvas2" width = "500" height = "400" style =' border : 1px solid #000 '; > </canvas>
      <script>
      var canvas2 = document.getElementById( "tcanvas2" );
      var context2 = canvas2.getContext( "2d" );
      // context2.fillStyle = "rgba(0,0,255,0.9)";
      // context2.fillRect(0,400,500,400);
      var img2 = new Image(); //이미지 객체 생성
      img2.src = "/media/test.png"; //code.jpg라는 이미지 파일을 로딩 시작
      img2.onload = function() //이미지 로딩 완료시 실행되는 함수
      {
      //(20,20)을 중심으로 100*100의 사이즈로 이미지를 그림 
      // context.globalAlpha=0.9;
      context.fillStyle = "rgba(0,0,0,0.1)";
      context.fillRect(0,400,500,400);
      context.drawImage(img2,0,400,500,400);
      }
      </script>
  </div>
</div>
<div id="nav">
<video width="400" controls>
    <source src="/media/Seoul - 21985.mp4" type="video/mp4">
    Your browser does not support HTML5 video.
  </video>

  
  <p>These are the frames' images generated by getVideoImage():</p>
  <ol id="olFrames"></ol>
  
  <script type="text/JavaScript">
  function getVideoImage(path, secs, callback) {
    var me = this, video = document.createElement('video');
    video.onloadedmetadata = function() {
      if ('function' === typeof secs) {
        secs = secs(this.duration);
      }
      this.currentTime = Math.min(Math.max(0, (secs < 0 ? this.duration : 0) + secs), this.duration);
    };
    video.onseeked = function(e) {
      var canvas = document.createElement('canvas');
      canvas.height = video.videoHeight-840;
      canvas.width = video.videoWidth-1580;
      var ctx = canvas.getContext('2d');
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      var img = new Image();
      img.src = canvas.toDataURL();
      callback.call(me, img, this.currentTime, e);
    };
    video.onerror = function(e) {
      callback.call(me, undefined, undefined, e);
    };
    video.src = path;
  }
  
  function showImageAt(secs) {
    var duration;
    getVideoImage(
      '/media/Seoul - 21985.mp4',
      function(totalTime) {
        duration = totalTime;
        return secs;
      },
      function(img, secs, event) {
        if (event.type == 'seeked') {
          var li = document.createElement('li');
          li.innerHTML += '<b>Frame at second ' + secs + ':</b><br />';
          var a = document.createElement('a');
          a.setAttribute('href', "{% url 'main:urltest' %}");
          url_list = [];
          url_list.push(img.src);
          a.appendChild(img);
          li.appendChild(a);
          {% comment %} li.appendChild(img); {% endcomment %}
          document.getElementById('olFrames').appendChild(li);
          console.log(url_list);
          if (duration >= ++secs) {
            showImageAt(secs);
          };
        }
      }
    );
  }
  showImageAt(0);
  </script>
</div>
  <p>
  Video courtesy of 
  <a href="https://www.bigbuckbunny.org/" target="_blank">Big Buck Bunny</a>.
  </p>

 
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:100,300,400,500,700,900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="/static/css/sidebar.css">
<div class="menu">
<label for="expand-menu"><div>메뉴</div></label><input type="checkbox" id="expand-menu" name="expand-menu">
<ul>
    <li><a href="#" class="item"><div>프로필</div></a></li>
    <li><a href="#" class="item"><div>데이터사용량</div></a></li>
    <li><a href="#" class="item"><div>내URL</div></a></li>
    <li><a href="#" class="item"><div>구매내역</div></a></li>
    <li><a href="#" class="item"><div>추천목록</div></a></li>
    <li><a href="#" class="item"><div>설정</div></a></li>
</ul>
</div>

<style>
    .logo{
        display:flex;
        height:75px;
        width:349px;
        margin-top:40px;
        margin-left:50px;
    }
    .flex{
        display:flex;
    }
    .task{
        display:flex;
        flex-direction:column;
        width:390px;
        height:800px;
        background-color:white;
    }
    .button {
        display: flex;
        justify-content: center;
    }
    #chooseFile{
        visibility: hidden;
    }
    label {
        cursor: pointer;
        font-size: 1em;
    }
    .canvas{
        height:800;
        width:1500px;
        background-color:white;
        margin-left:10px;
    }
    .camera{
        align-items:center;
        margin-top:40%;
        height:250px;
        width:350px;
    }
</style>

<div>
    <img class="logo" src="/static/image/찐로고.png" onclick="location.href='{% url 'main:home' %}'">
</div>
<div class="flex">
    <div class="task">
        <img class="camera" src="/static/image/camera.png">
        <div class="container">
            <div class="image-upload" id="image-upload">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="button">
                        <label for="chooseFile">
                            
                            <input type="button" accept="img/" required multiple style="background-color: #708ae8; border:none; width:100%;" class="btn btn-primary">동영상 업로드</button>
                        </label>
                    </div>
                    <input type="file" id="chooseFile" name="chooseFile" accept="image/*" onchange="loadFile(this)">
                </form>
                <div class="fileContainer">
                    <div class="fileInput">
                        <p>FILE : </p>
                        <p id="fileName"></p>
                    </div>
                    <div class="buttonContainer">
                        <div class="submitButton" id="submitButton">SUBMIT</div>
                    </div>
                </div>
            </div>
            
            <div class="image-show" id="image-show"></div>
        </div>
        <script src="/static/js/canvas.js"></script>
            
        
    </div>
    <div class="canvas">

    </div>
</div>




{% endblock %}